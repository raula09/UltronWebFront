import{Fa as k,Ga as E,Ha as w,Ia as y,Ja as T,L as o,P as f,Q as v,U as d,Ua as M,Y as l,Ya as U,Za as F,aa as r,ba as t,fa as b,ha as u,ia as p,ka as h,la as n,ma as C,na as c,oa as P,ua as _,va as O,wa as S,xa as I,y as g,z as x}from"./chunk-WMCA5TTY.js";function N(i,a){if(i&1&&(r(0,"li"),n(1),_(2,"currency"),t()),i&2){let e=a.$implicit;o(),P(" ",e.productName," - Quantity: ",e.quantity," - Price: ",O(2,3,e.price)," ")}}function L(i,a){if(i&1&&(r(0,"div",13)(1,"p")(2,"strong"),n(3,"Order ID:"),t(),n(4),t(),r(5,"p")(6,"strong"),n(7,"Date:"),t(),n(8),_(9,"date"),t(),r(10,"ul"),d(11,N,3,5,"li",14),t()()),i&2){let e=a.$implicit;o(4),c(" ",e.id,""),o(4),c(" ",S(9,3,e.timestamp,"medium"),""),o(3),l("ngForOf",e.items)}}function R(i,a){if(i&1&&(r(0,"div"),d(1,L,12,6,"div",12),t()),i&2){let e=p(3);o(),l("ngForOf",e.orders)}}function V(i,a){i&1&&(r(0,"p"),n(1,"No previous orders found."),t())}function j(i,a){if(i&1&&(r(0,"div",10),d(1,R,2,1,"div",11)(2,V,2,0,"ng-template",null,0,I),t()),i&2){let e=h(3),s=p(2);o(),l("ngIf",s.orders.length>0)("ngIfElse",e)}}function z(i,a){if(i&1){let e=b();r(0,"div",3)(1,"div",4)(2,"h2"),n(3,"User Profile"),t(),r(4,"p")(5,"strong"),n(6,"Name:"),t(),n(7),t(),r(8,"p")(9,"strong"),n(10,"Email:"),t(),n(11),t(),r(12,"p")(13,"strong"),n(14,"Phone:"),t(),n(15),t(),r(16,"div",5)(17,"button",6),u("click",function(){g(e);let m=p();return x(m.logout())}),n(18,"Logout"),t(),r(19,"button",7),n(20,"Reset Password"),t()()(),r(21,"h3",8),u("click",function(){g(e);let m=p();return x(m.toggleOrders())}),n(22," Previous Orders "),r(23,"span"),n(24),t()(),d(25,j,4,2,"div",9),t()}if(i&2){let e=p();o(7),c(" ",e.user.username,""),o(4),c(" ",e.user.email,""),o(4),c(" ",e.user.phoneNumber,""),o(9),C(e.showOrders?"\u25B2":"\u25BC"),o(),l("ngIf",e.showOrders)}}function B(i,a){i&1&&(r(0,"div",15),n(1,` Loading user information...
`),t())}var D=class i{constructor(a,e,s){this.authService=a;this.tokenService=e;this.router=s}user=null;orders=[];loading=!0;showOrders=!1;ngOnInit(){if(!this.tokenService.getTokenFromLocalStorage()){this.router.navigate(["/sign-in"]);return}this.authService.getProfile().subscribe({next:e=>{this.user=e.user,this.orders=(e.orders||[]).sort((s,m)=>new Date(m.timestamp).getTime()-new Date(s.timestamp).getTime()),this.loading=!1},error:()=>{this.router.navigate(["/sign-in"])}})}toggleOrders(){this.showOrders=!this.showOrders}logout(){this.authService.logout().subscribe({next:()=>{this.tokenService.removeTokenFromLocalStorage(),this.router.navigate(["/sign-in"])},error:()=>{this.tokenService.removeTokenFromLocalStorage(),this.router.navigate(["/sign-in"])}})}static \u0275fac=function(e){return new(e||i)(f(F),f(U),f(M))};static \u0275cmp=v({type:i,selectors:[["app-user-profile"]],decls:2,vars:2,consts:[["noOrders",""],["class","profile-container",4,"ngIf"],["class","loading",4,"ngIf"],[1,"profile-container"],[1,"profile-info-box"],[1,"profile-actions"],[1,"btn",3,"click"],["routerLink","/password-reset",1,"btn","reset-btn"],[1,"orders-title",3,"click"],["class","orders-box",4,"ngIf"],[1,"orders-box"],[4,"ngIf","ngIfElse"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],[4,"ngFor","ngForOf"],[1,"loading"]],template:function(e,s){e&1&&d(0,z,26,5,"div",1)(1,B,2,0,"div",2),e&2&&(l("ngIf",!s.loading),o(),l("ngIf",s.loading))},dependencies:[T,k,E,y,w],styles:[".profile-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:20px}.profile-info-box[_ngcontent-%COMP%]{padding:30px;background-color:#f5f5f5;border-radius:10px;box-shadow:0 6px 12px #0000001a;margin-bottom:20px}.profile-info-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;margin:8px 0}.profile-actions[_ngcontent-%COMP%]{margin-top:15px;display:flex;gap:10px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-size:.95rem;background-color:#007bff;color:#fff}.reset-btn[_ngcontent-%COMP%]{background-color:#28a745}.orders-title[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;margin-top:20px;display:flex;justify-content:space-between;align-items:center;font-size:1.2rem}.orders-box[_ngcontent-%COMP%]{max-height:250px;overflow-y:auto;margin-top:10px;padding:10px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;border-radius:8px}.order-card[_ngcontent-%COMP%]{padding:10px;margin-bottom:10px;background-color:#fff;border-radius:6px;box-shadow:0 2px 4px #0000000d}.order-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin:5px 0 0}.loading[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;padding:40px}"]})};export{D as UserProfileComponent};
